## T-01: Client-Side Routing (Phase 0, Tracer Bullet A) — DONE

Installed react-router v7 and replaced manual URL/history management with proper client-side routing.

### Changes
- `client/package.json` — added `react-router` dependency
- `client/src/App.tsx` — replaced `window.location.replace("/")` redirect with `BrowserRouter` + `Routes` (`/`, `/session/:sessionId`, `*` 404 catch-all)
- `client/src/views/DashboardView.tsx`:
  - Replaced `parseEmbeddedSessionId()` with `useParams` hook
  - Replaced `history.pushState` with `useNavigate`
  - Removed `popstate` event listener (router handles back/forward natively)
  - Replaced `<a>` tags with `<Link>` from react-router
  - Removed unused `onSelectSession` prop from `ProjectTreeItem`
- Also created `NotFoundPage` in App.tsx for the 404 catch-all route

### Verification
- TypeScript: passes (`bun run typecheck`)
- Tests: 511/511 pass (`bun test`)
- Lint: only pre-existing shadcn/ui warnings (not introduced by this change)
- SPA fallback already configured in `src/api/create-app.ts` (lines 173-181)

## T-02: Worktree Scanning (Phase 0, Tracer Bullet B) — DONE

Full end-to-end worktree scanning: scanner → API → client fetch → sidebar UI.

### Changes
- `src/scanner/types.ts` — added `WorktreeSummary` interface (name, path)
- `src/scanner/scan-worktrees.ts` — new file: scans `<projectPath>/.claude/.worktrees/` for subdirectories, returns sorted array, gracefully handles missing/empty dirs
- `src/scanner/index.ts` — exported `scanWorktrees` and `WorktreeSummary`
- `src/api/types.ts` — added `scanWorktrees` to `AppDependencies.scanner`
- `src/api/create-app.ts` — added `GET /api/projects/:projectId/worktrees` endpoint (decodes project ID to filesystem path, calls `scanWorktrees`)
- `src/main.ts` — wired `scanWorktrees` into server dependencies
- `src/api/__tests__/create-app.test.ts` — added 3 tests for worktree endpoint (200 with data, 404, empty array)
- `src/api/__tests__/helpers.ts` — added `scanWorktrees` to mock defaults
- `src/api/__tests__/create-server.test.ts` — added `scanWorktrees` to partial scanner override (fixed TS error)
- `src/scanner/__tests__/scan-worktrees.test.ts` — new file: 6 tests covering happy path, non-dir filtering, empty dir, missing dir, nonexistent path, sort order
- `src/scanner/__tests__/fixtures/worktree-project/` — test fixtures with 2 worktree dirs + 1 non-dir entry
- `src/scanner/__tests__/fixtures/worktree-project-empty/` — empty worktrees dir fixture
- `src/scanner/__tests__/fixtures/worktree-project-no-claude/` — no .claude dir fixture
- `client/src/types/api.ts` — added `WorktreeSummary` interface (client-side mirror)
- `client/src/lib/api.ts` — added `fetchWorktrees(projectId)` with retry support
- `client/src/views/DashboardView.tsx`:
  - Added `worktreeCache` state and `handleWorktreesLoaded` callback
  - `ProjectTreeItem` fetches worktrees in parallel with sessions on expand
  - Sidebar displays "worktrees" section title with `GitBranch` icons
  - Shows `(no worktrees)` placeholder when empty
  - Worktree tooltips show full filesystem path

### Edge Cases Handled
- Missing `.claude/.worktrees/` directory → empty array, `(no worktrees)` placeholder
- Empty `.claude/.worktrees/` directory → same
- Non-directory entries in `.worktrees/` → filtered out
- Project path decoding uses same `replaceAll("-", "/")` convention as `scan-projects.ts`

### Verification
- TypeScript: passes (`bun run typecheck`)
- Tests: 520/520 pass (`bun test`) — 9 new tests (6 scanner + 3 API)
- No lint script configured

## T-03: Remove Action Bar (Phase 1) — DONE

Deleted the Stop/Resume/New Session button bar from SessionPanel.

### Changes
- `client/src/views/SessionPanel.tsx`:
  - Removed the action buttons `<div>` (Stop, Resume, New Session) and its `border-b` container
  - Removed unused destructured vars from `useSessionData` hook call: `handleStop`, `handleResume`, `handleNewSession`, `actionLoading`
  - Left `useSessionData` hook exports intact (hook API unchanged — handlers may be re-used later)
  - Left `projectId` and `onGoSession` props intact (still passed to the hook)

### Verification
- TypeScript: passes (`bun run typecheck`)
- Tests: 520/520 pass (`bun test`)
- Net: removed 30 lines of UI code, component dropped from 320 to 286 lines

## T-04: Analytics Sheet (Phase 1) — DONE

Replaced the inline grid-based analytics panel with a slide-out Sheet overlay. Analytics now defaults to closed and opens via a side sheet.

### Changes
- `client/src/hooks/use-session-data.ts`:
  - Changed `analyticsOpen` default from `true` to `false`
- `client/src/views/SessionPanel.tsx`:
  - Imported `Sheet`, `SheetContent`, `SheetTitle`, `SheetTrigger` from `@/components/ui/sheet`
  - Wrapped component return in `<Sheet open={analyticsOpen} onOpenChange={setAnalyticsOpen}>`
  - Replaced the toggle button's `onClick` with `<SheetTrigger asChild>` wrapper
  - Removed the two-column grid layout (`gridTemplateColumns: analyticsOpen ? "1fr 360px" : "1fr"`)
  - Conversation area now always uses full width
  - Moved `AnalyticsPanel` into `<SheetContent side="right">` with 360px width, no close button (toggle button handles open/close)
  - Added `<SheetTitle className="sr-only">` for accessibility (Radix Dialog requires a title)

### Verification
- TypeScript: passes (`bun run typecheck`)
- Tests: 520/520 pass (`bun test`)

## T-05: Session Pagination (Phase 1) — DONE

Added server-side `?limit=N` query parameter to the sessions endpoint and client-side "Show all sessions" button when the initial paginated fetch returns exactly 20 results.

### Changes
- `src/api/create-app.ts`:
  - `GET /api/projects/:projectId/sessions` now parses optional `?limit=N` query parameter
  - When present and > 0, slices the scanner results to `limit` entries
  - Without `?limit`, returns all sessions (backwards compatible)
- `client/src/lib/api.ts`:
  - `fetchSessions(projectId, limit?)` accepts an optional `limit` parameter, appends `?limit=N` to the URL when provided
- `client/src/views/DashboardView.tsx`:
  - Added `SESSION_PAGE_SIZE = 20` constant
  - Initial fetch uses `fetchSessions(project.id, SESSION_PAGE_SIZE)`
  - Tracks `truncated` state (true when exactly 20 sessions returned)
  - Shows "Show all sessions" button with `ChevronsDown` icon when truncated
  - Clicking re-fetches without limit, replaces cached sessions, clears truncated state
  - Added `loadingAll` state for loading indicator on the button
- `src/api/__tests__/create-app.test.ts`:
  - Added 2 tests: `?limit=3` returns 3 of 5 sessions; no limit returns all 5

### Verification
- TypeScript: passes (`bun run typecheck`)
- Tests: 522/522 pass (`bun test`) — 2 new tests
