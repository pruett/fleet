## 2026-02-20 — Phase 0: Project Scaffolding + Types

Implemented the first task group from Phase 0 (Tracer Bullet).

### What was done
- Created `src/scanner/types.ts` with `ProjectSummary` and `SessionSummary` interfaces matching the spec
- Created `src/scanner/index.ts` with placeholder type re-exports
- Created `src/scanner/__tests__/fixtures/base-path/-Users-foo-code-bar/a1b2c3d4-...jsonl` — minimal 4-line transcript (snapshot, user prompt, assistant text, turn_duration)

### Files changed
- `src/scanner/types.ts` (new)
- `src/scanner/index.ts` (new)
- `src/scanner/__tests__/fixtures/base-path/-Users-foo-code-bar/a1b2c3d4-e5f6-7890-abcd-ef1234567890.jsonl` (new)

### Notes
- `bun install` was needed (no `node_modules` in worktree)
- Typecheck and all 387 existing parser tests pass
- Fixture uses sessionId matching the UUID filename, model `claude-sonnet-4-20250514`, 10 input / 20 output tokens

## 2026-02-20 — Phase 0: scanProjects implementation

Implemented `scanProjects(basePaths)` — the first function in the "Minimal scanProjects + scanSessions" task group.

### What was done
- Created `src/scanner/scan-projects.ts` with full `scanProjects` implementation:
  - Iterates base paths, reads directory entries
  - Skips non-directories, dot-prefixed dirs, and `memory` dir
  - Decodes path (`-` → `/`)
  - Calls `scanSessions` per project for `sessionCount` and `lastActiveAt`
  - Sorts results by `lastActiveAt` descending (nulls last)
  - Silently skips missing/unreadable base paths
- Created `src/scanner/scan-sessions.ts` as a stub (returns `[]`) — dependency for `scanProjects` to compile; will be implemented in next task

### Files changed
- `src/scanner/scan-projects.ts` (new)
- `src/scanner/scan-sessions.ts` (new — stub)

### Notes
- Typecheck passes, all 387 parser tests still pass
- `scanProjects` relies on `scanSessions` being sorted by `lastActiveAt` desc — uses `sessions[0]?.lastActiveAt ?? null` for project-level recency
- Path decoding is lossy (hyphens in original paths are ambiguous) — matches spec behavior

## 2026-02-20 — Phase 0: scanSessions implementation

Implemented `scanSessions(projectDir)` — the directory scanning and filtering logic for session files.

### What was done
- Replaced `src/scanner/scan-sessions.ts` stub with full implementation:
  - Reads directory entries from project dir (silently returns `[]` on error)
  - Skips directories (excludes subagent companion dirs)
  - Skips non-`.jsonl` files
  - Skips files whose stem is not a valid UUID (case-insensitive regex)
  - Calls `extractSessionSummary(filePath, sessionId)` for each valid file
  - Sorts results by `lastActiveAt` descending (nulls last)
- Created `src/scanner/extract-session-summary.ts` as a stub — returns a `SessionSummary` with the given `sessionId` and all other fields null/zero; will be implemented in next task

### Files changed
- `src/scanner/scan-sessions.ts` (replaced stub with full implementation)
- `src/scanner/extract-session-summary.ts` (new — stub)

### Notes
- Typecheck passes, all 387 parser tests still pass
- UUID regex: `/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i`
- Uses `node:path` `basename`/`extname` for robust filename parsing
- Same sorting pattern as `scanProjects` (nulls last via comparator)

## 2026-02-20 — Phase 0: extractSessionSummary implementation

Replaced the stub with full selective JSONL reading for session metadata.

### What was done
- Replaced `src/scanner/extract-session-summary.ts` stub with full implementation:
  - Reads file contents, splits into non-empty lines
  - Scans header lines (up to first non-meta user record) for: `startedAt` (earliest timestamp, including `snapshot.timestamp` for file-history-snapshot records), `firstPrompt` (first non-meta user message content, truncated to 200 chars), `cwd`, `gitBranch`
  - Scans backwards from end for `lastActiveAt` (first line with a `timestamp` field, since `system`/`turn_duration` records lack timestamps)
  - `slug` returns `null` — not present in the JSONL format
  - `model` returns `null` — deferred to Phase 1 (token aggregation)
  - Token fields stubbed to zero — deferred to Phase 1
  - Malformed JSON lines silently skipped
  - File read errors return empty summary (all null/zero)
  - Empty files return empty summary

### Files changed
- `src/scanner/extract-session-summary.ts` (replaced stub with full implementation)

### Notes
- Typecheck passes, all 387 parser tests still pass
- `startedAt` checks both top-level `timestamp` and `snapshot.timestamp` for file-history-snapshot records
- `lastActiveAt` scans backwards because the typical last line (`system`/`turn_duration`) has no timestamp — the last assistant or user record does
- `slug` is not in the JSONL format; may need a separate source or convention in a later phase

## 2026-02-20 — Phase 0: scan-projects.test.ts

Created the first scanner test file covering `scanProjects`.

### What was done
- Created `src/scanner/__tests__/scan-projects.test.ts` with 3 tests:
  - Scans fixture base path and verifies 1 project with correct `id`, `path`, `source`, `sessionCount`, `lastActiveAt`
  - Silently skips a missing base path (returns empty array)
  - Merges results from multiple base paths (one missing, one valid)

### Files changed
- `src/scanner/__tests__/scan-projects.test.ts` (new)

### Notes
- All 390 tests pass (387 parser + 3 new scanner), typecheck passes
- `lastActiveAt` is `2026-02-18T10:00:02.000Z` — the assistant record timestamp, not the system/turn_duration line which lacks a timestamp

## 2026-02-20 — Phase 0: scan-sessions.test.ts

Created the scanner test file covering `scanSessions`.

### What was done
- Created `src/scanner/__tests__/scan-sessions.test.ts` with 3 tests:
  - Scans fixture project dir and verifies 1 session with correct `sessionId`, `slug`, `firstPrompt`, `startedAt`, `lastActiveAt`
  - Silently returns empty for a missing project dir
  - Silently returns empty for a directory with no `.jsonl` session files
- Marked the **Verify** checkpoint as done — `bun test src/scanner` passes end-to-end (6 scanner tests)

### Files changed
- `src/scanner/__tests__/scan-sessions.test.ts` (new)
- `plans/project-scanner.md` (updated checkboxes)

### Notes
- All 393 tests pass (387 parser + 6 scanner), typecheck passes
- Phase 0 (Tracer Bullet) is now fully complete
